<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css"
              integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js"
                integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
                crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js"
                integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
                crossorigin="anonymous"></script>

        <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/jquery-ui.min.js"></script>

        <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css">
        <link rel="stylesheet" href="css/main.css">
        <script src="js/plugins.js"></script>
        <script src="js/main.js"></script>
    <script>
        // this is a dictionary of folders and their elements
        var folders = {
            "Pictures": ['BIRB_1_div','BIRB_2_div','BIRB_3_div']
        }
        var numPDFClicks = 0;
        var numIMGClicks = 0;
        var numMovieClicks = 0;
        var numRenames = 0;
        var numCtrC = 0;
        var numCtrV = 0;

        function clicked(type, src) {
            filenames = getFileNames($(src).parent().parent().attr('id'), type)
            if (type == 'pdf') {
                numPDFClicks++;
            }
            else if (type == 'img') {
                numIMGClicks++;
                if (numIMGClicks > 2) {
                    makeRenameDialogue('renameDialogueDiv', filenames)
                    resetClicks()
                }
            }
        }

        function resetClicks() {
            numPDFClicks = 0;
            numIMGClicks = 0;
            numMovieClicks = 0;
            numCtrC = 0;
            numCtrV = 0;
        }

        function triggerAutoRename() {
            // open the dialogue for the current folder if the threshold is met
            if (numRenames > 2) {
                if (numPDFClicks > 2) {
                    console.log('trigger rename pdfs in the folder') // e.g. makeRenameDialogue('dialogueDiv, getFileNames('current_folder', 'vlc'))
                } else if (numMovieCLicks > 2) {
                    console.log('trigger rename movies in the folder')
                } else if (numIMGClicks > 2) {
                    console.log('trigger rename imgs in the folder')
                }
            }
        }
        /**
         *
         * @param folder - div name of a folder containing files
         * @type type of files we want to include in the return. can be null if you want everything in Folder
         * @returns {Array} of filenames in the folder
         */
        function getFileNames(folder, type) {
            var values = [];
//            console.log(folder + " " + type)
            $("#" + folder).children().each(function() {
                if (type == undefined || $(this).attr("class").indexOf(type) >= 0) {
                    values.push($(this).find('p').text());
                }
            })
            return values;
        }

        $(document).ready(function() {
            // when the page has loaded, make all the draggable items draggable
            $(".draggable").each(function() {
                $(this).draggable({
                    drag: function( event, ui ) {
                        var snapTolerance = $(this).draggable('option', 'snapTolerance');
                        var topRemainder = ui.position.top % 20;
                        var leftRemainder = ui.position.left % 20;

                        if (topRemainder <= snapTolerance) {
                            ui.position.top = ui.position.top - topRemainder;
                        }

                        if (leftRemainder <= snapTolerance) {
                            ui.position.left = ui.position.left - leftRemainder;
                        }
                    },
                    containment: 'document'
                });

            })

            $(".vlc").each(function() {
                $(this).on('contextmenu', function() {
                    console.log($(this).attr('id'))
                });
            })

            // closes the start menu if its open and you click outside of it
            $(document).mouseup(function(e) {
                var container = $("#startMenu");
                if (!container.is(e.target) && container.has(e.target).length === 0) {
                    container.hide();
                }
            });
        });

    </script>
    </head>
    <body class="body" id="body">
        <div id="renameDialogueDiv"></div>
        <div id="desktop_folder" class="container">
            <div class="row">
                <div class="col-sm-2 icon draggable pdf">
                    <image class='pdf-icon' ondblclick="makeViewerDialogue('A1.pdf', 'A1pdf');"></image>
                    <p id="file_f10f903">file_f10f903</p>
                    <!-- this is a pdf which means it can trigger a dialogue so it needs a corresponding div where the dialogue will open -->
                    <div id="A1pdf"></div>
                </div>
                <div class="col-sm-2 icon draggable pdf">
                    <image class='pdf-icon'
                           ondblclick="makeRenameDialogue('renameDialogueDiv', getFileNames('desktop_folder', 'pdf'));"></image>
                    <p id="file_ab42nl">file_ab42nl</p>
                </div>
                <div class="col-sm-2 icon draggable img">
                    <image class='img-icon' src='img/birb.jpg'
                           ondblclick="makeRenameDialogue('renameDialogueDiv', getFileNames('desktop_folder', 'img'));"></image>
                    <p id="IMG_94_9260">IMG_94_9260</p>
                </div>
                <div class="col-sm-2 icon draggable folder">
                    <image class='img-icon' src='img/notepad-icon.png'
                           ondblclick=""></image>
                    <p id="notepad-name">Notepad</p>
                </div>
                <div class="col-sm-2 icon draggable folder">
                    <image class='folder-icon'
                           ondblclick="makeFolderDialogue('Pictures', 'pictures_dialogue', 'pictures_content')"></image>
                    <p id="Pictures">Pictures</p>
                    <!-- this is a folder which means it can trigger a dialogue so it needs a corresponding div where the dialogue will open -->
                    <div id="pictures_dialogue"></div>
                    <!-- default items in Pictures that get cloned into a dialogue when this is opened-->
                    <div id="pictures_content" style="display:none">
                        <div class="icon draggable img" id="BIRB_1_div">
                            <image class='img-icon' src='img/birb.jpg'
                                   ondblclick="clicked('img', this);"></image>
                            <p id="BIRB_1">BIRB_1</p>
                        </div>
                        <div class="icon draggable img" id="BIRB_2_div">
                            <image class='img-icon' src='img/birb.jpg'
                                   ondblclick="clicked('img',this);"></image>
                            <p id="BIRB_2">BIRB_2</p>
                        </div>
                        <div class="icon draggable img" id="BIRB_3_div">
                            <image class='img-icon' src='img/birb.jpg'
                                   ondblclick="clicked('img',this)"></image>
                            <p id="BIRB_3">BIRB_3</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="icon draggable folder">
                <image class='folder-icon' ondblclick="makeFolderDialogue('episodes', 'episodes_dialogue', 'episodes_content')"></image>
                <p id="episodes">Movies</p>
                <!-- this is a folder which means it can trigger a dialogue so it needs a corresponding div where the dialogue will open -->
                <div id="episodes_dialogue"></div>
                <!-- default items in Pictures that get cloned into a dialogue when this is opened-->
                <div id="episodes_content" style="display:none">
                    <div class="icon draggable vlc" id="TGP_0">
                        <!-- image's parent.parent is its containing folder -->
                        <image class='vlc-icon' ondblclick="clicked('vlc', this)"></image>
                        <p class='tgp' id="TGP_0_text">The.Good.Place.S01E01.Everything Is Fine.avi</p>
                    </div>
                    <div class="icon draggable vlc"id="TGP_1">
                        <image class='vlc-icon' ondblclick="clicked('vlc', this)"></image>
                        <p class='tgp' id="TGP_1_text">The.Good.Place.S01E02.Flying.mp4</p>
                    </div>
                    <div class="icon draggable vlc"id="TGP_2">
                        <image class='vlc-icon' ondblclick="clicked('vlc', this)"></image>
                        <p class="tgp" id="TGP_2_text">The.Good.Place.S01E03.HDTV.x264-KILLERS.mp4</p>
                    </div>
                    <div class="icon draggable vlc"id="TWD_0">
                        <image class='vlc-icon' ondblclick="clicked('vlc', this)"></image>
                        <p class='twd' id="TWD_0_text">The.Walking.Dead.S08E01.1080p.WEB-DL.DD5.1.H264-RARBG.mp4</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="startMenu">
            <ul>
                <li>Notepad</li>
                <li>Internet</li>
            </ul>
        </div>

        <div class="container">
            <div id="taskbar" class="row">
                <span class="taskbar-item" onclick="$('#startMenu').toggle()">Start</span>
            </div>
        </div>

        <ul class='rightclick-menu'>
            <li data-action="rename">Rename</li>
            <!--<li data-action="second">Second thing</li>-->
            <!--<li data-action="third">Third thing</li>-->
        </ul>
    </body>
</html>
